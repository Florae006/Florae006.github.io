# å°æœºå™¨äººdodolaï¼Œå¯åŠ¨ï¼




> æ‹¥æœ‰ä¸€ä¸ªè‡ªå·±çš„å°æœºå™¨äººä¸æ˜¯è¶…é…·çš„ä¹ˆðŸ˜Ž

æœ¬éƒ¨åˆ†å°†ä»Ž0å¼€å§‹ä»‹ç»ä¸€ä¸ªqqæœºå™¨äººçš„åˆ¶ä½œä»¥åŠéƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚

# 0.çŽ¯å¢ƒä¸€è§ˆ

> å¼€å‘çŽ¯å¢ƒï¼šWindows11
>
> pythonè™šæ‹ŸçŽ¯å¢ƒç‰ˆæœ¬ï¼š3.10.9
>
> nonebot cliç‰ˆæœ¬ï¼š1.2.6
>
> æ–‡æœ¬ç¼–è¾‘å™¨ï¼šVSCode

> æœåŠ¡å™¨çŽ¯å¢ƒï¼šåŽä¸ºäº‘ 2æ ¸2G|ç³»ç»Ÿç›˜40GB|å³°å€¼å®½å¸¦3M|å®å¡”Linuxé¢æ¿8.0.0.1
>
> Ubuntuç‰ˆæœ¬ï¼š22.04.2 LTS (GNU/Linux 5.15.0-76-generic x86_64)

# 1.NoneBotï¼Œå¯åŠ¨ï¼

é€‰æ‹©çš„èŠå¤©æœºå™¨äººæ¡†æž¶æ˜¯NoneBot2ï¼Œå®˜æ–¹ä½¿ç”¨æ–‡æ¡£åœ¨æ­¤ï¼š[æ¦‚è§ˆ | NoneBot](https://nonebot.dev/docs/)

## è„šæ‰‹æž¶nb-cli

å…ˆåœ¨è‡ªå·±é€‰æ‹©å­˜æ”¾æœºå™¨äººçš„ç›®å½•ä¸‹æ‰“å¼€vscode

æŽ¨èåœ¨è™šæ‹ŸçŽ¯å¢ƒä¸‹è¿›è¡Œæœºå™¨äººçš„å¼€å‘ï¼Œè¿™é‡Œå…ˆå®‰è£…pipx

æ‰“å¼€vscodeç»ˆç«¯ï¼Œä¾æ¬¡è¾“å…¥ä»¥ä¸‹ä¸¤è¡Œå‘½ä»¤

```bash
python -m pip install --user pipx
python -m pipx ensurepath
```

å¦‚æžœå‡ºçŽ°ä¸€äº›æç¤ºè´¦æˆ·çŽ¯å¢ƒå˜é‡è¿™æ ·çš„WARNINGï¼Œè¯·å…³æ³¨ï¼Œå…·ä½“æ€Žä¹ˆè°ƒæ•´çŽ¯å¢ƒå˜é‡å¦è¡Œæœç´¢ã€‚

å®‰è£…å®Œæˆä¹‹åŽï¼Œå…³é—­å½“å‰vscodeçª—å£ï¼Œé‡å¯vscodeï¼Œè™šæ‹ŸçŽ¯å¢ƒç”Ÿæ•ˆã€‚

é‡å¯ä¹‹åŽï¼Œæ–°å»ºç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å®‰è£…è„šæ‰‹æž¶

```bash
pipx install nb-cli
```

å¦‚æžœå‡ºçŽ°æ— æ³•æ‰¾åˆ°å‘½ä»¤çš„é”™è¯¯æç¤ºã€‚1.æ£€æŸ¥çŽ¯å¢ƒå˜é‡ï¼›2.é‡å¯VSCodeï¼›å¦‚æžœä»ç„¶ä¸è¡Œï¼š3.é‡å¯è®¡ç®—æœºï¼Œè¿˜æ˜¯ä¸è¡Œï¼š4.æ‰¾ä¸€ä¸ªé«˜æ‰‹å¸®ä½ debug

å®‰è£…æˆåŠŸä¹‹åŽä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š

```bash
nb --version
```

å¦‚æžœèƒ½è¿”å›žè„šæ‰‹æž¶ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™ä»£è¡¨å®‰è£…æˆåŠŸ

## åˆ›å»ºé¡¹ç›®

ä½¿ç”¨æ‰‹è„šæž¶åˆ›å»ºé¡¹ç›®ï¼š

```bash
nb create
```

è¯¥æŒ‡ä»¤ä¹‹åŽä¼šä¸€ä¸€ç³»åˆ—è¯¢é—®å¸®åŠ©æˆ‘ä»¬åˆ›å»ºé¡¹ç›®ï¼š

```plain
[?] é€‰æ‹©ä¸€ä¸ªè¦ä½¿ç”¨çš„æ¨¡æ¿: bootstrap (åˆå­¦è€…æˆ–ç”¨æˆ·)	# å¯ä»¥å®‰è£…å•†åº—çš„æ’ä»¶ï¼Œä¹‹åŽä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™ä¸€äº›æ’ä»¶
[?] é¡¹ç›®åç§°: awesome-bot	# ç»™ä½ çš„botå–ä¸ªåå­—ï¼Œæœ€å¥½è‹±æ–‡
[?] è¦ä½¿ç”¨å“ªäº›é©±åŠ¨å™¨? FastAPI (FastAPI é©±åŠ¨å™¨)	# ä¸€èˆ¬éƒ½ç”¨è¿™ä¸ª
[?] è¦ä½¿ç”¨å“ªäº›é€‚é…å™¨? OneBot V11 (OneBot V11 åè®®) # V12ä¼¼ä¹Žè¿˜ä¸ç¨³å®š
[?] ç«‹å³å®‰è£…ä¾èµ–? (Y/n) Yes
[?] åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ? (Y/n) Yes
```

ä¹‹åŽè„šæ‰‹æž¶ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºå¹¶å¼•å…¥æ‰€éœ€è¦çš„ä¾èµ–åŒ…

![botstart1](https://img.dodolalorc.cn/i/2024/10/01/66fbc12f60c58.png)

æœ€åŽé€‰æ‹©å®‰è£…å†…ç½®æ’ä»¶`echo`ï¼Œä¸€ä¸ªç®€å•çš„å¤è¯»æ’ä»¶ç”¨äºŽåˆæœŸæµ‹è¯•æœºå™¨äººæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚

```plain
[?] è¦ä½¿ç”¨å“ªäº›å†…ç½®æ’ä»¶? echo	# æ³¨æ„è¿™ä¸ªæ’ä»¶è¦æ˜¯æ²¡æœ‰å®‰è£…ï¼ŒåŽç»­æ— æ³•è¡¥è£…ï¼Œåªèƒ½é‡æ–°åˆ›å»ºä¸€ä¸ªæœºå™¨äººé¡¹ç›®å“©
```

![æ“ä½œæˆªå›¾2](https://img.dodolalorc.cn/i/2024/10/01/66fbc181dc111.png)

æŽ¥ä¸‹æ¥æŒ‰ç…§æç¤ºrunä¸€ä¸‹é¡¹ç›®å°±è¡Œ

```bash
cd ./awesome-bot
nb run --reload
```

çŽ°åœ¨runä¸€ä¸‹åªæ˜¯åˆå§‹åŒ–ï¼ŒrunæˆåŠŸä¹‹åŽctrl+Cç»ˆæ­¢è¿›ç¨‹ï¼Œæˆ‘ä»¬æ¥åˆ°ä¸‹ä¸€æ­¥ç¼–è¾‘é…ç½®ã€‚

![firstrun](https://img.dodolalorc.cn/i/2024/10/01/66fbc18a5e97a.png)

æŽ¥ä¸‹æ¥çš„å¯¹æœºå™¨äººçš„æž„å»ºéƒ½è¦åœ¨é¡¹ç›®æ–‡ä»¶ä¸‹ï¼Œæ–¹ä¾¿èµ·è§æˆ‘ä»¬å¯ä»¥é‡æ–°æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œä½¿æ ¹ç›®å½•æ˜¯æˆ‘ä»¬çš„awsome-bot

å¦‚æžœä¹‹å‰è™šæ‹ŸçŽ¯å¢ƒæ¿€æ´»æˆåŠŸçš„è¯ï¼Œè¿›å…¥è¿™ä¸ªé¡¹ç›®ç›®å½•ä¸‹ä¼šè‡ªåŠ¨è¿›å…¥æœ¬é¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒä¸­ï¼Œå°±åƒè¿™æ ·ï¼š

![virtualenv](https://img.dodolalorc.cn/i/2024/10/01/66fbc19be67a7.png)

æœ‰æ¡†æ¡†å†…æ˜¾ç¤ºçš„è¿™ä¸ªæ‹¬å·ä»£è¡¨æˆ‘ä»¬åœ¨æœ¬é¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒä¸‹å“©ã€‚

å¦‚æžœæ²¡æœ‰æˆåŠŸè¿›å…¥ï¼Œå¯ä»¥è¯•è¯•åœ¨ç»ˆç«¯è¾“å…¥è¿™ä¸ªå‘½ä»¤ï¼š

```bash
./.venv/Scripts/Activate
```

ï¼ˆæŠ¥é”™æ‰¾ä¸åˆ°è·¯å¾„çš„è¯å°±åœ¨è‡ªå·±çš„æ–‡ä»¶å¤¹ä¸‹æ‰¾æ‰¾è¿™ä¸ªactivateè„šæœ¬åˆ°åº•åœ¨å“ªé‡Œqwq

æˆ–è€…ç›´æŽ¥è¾“å…¥å®Œæ•´åˆ°activateè„šæœ¬çš„è·¯å¾„åï¼ˆä»Žç›˜ç›®å½•å¼€å§‹

æˆ–è€…æ‰¾ä¸€ä¸ªé«˜æ‰‹å¸®ä½ debug

## ç¼–è¾‘é…ç½®

è„šæ‰‹æž¶å·²ç»ä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºäº†é…ç½®æ–‡ä»¶`.env.prod`

æˆ‘ä»¬ç¼–è¾‘å®ƒï¼š

```ini
DRIVER=~fastapi		# è„šæ‰‹æž¶ç”Ÿæˆçš„

HOST=127.0.0.1  # é…ç½® NoneBot ç›‘å¬çš„ IP / ä¸»æœºå
PORT=5478  # é…ç½® NoneBot ç›‘å¬çš„ç«¯å£
COMMAND_START=[""]  # é…ç½®å‘½ä»¤èµ·å§‹å­—ç¬¦
# COMMAND_SEP=["."]  # é…ç½®å‘½ä»¤åˆ†å‰²å­—ç¬¦
```

å…¶ä¸­ï¼Œ`HOST`å¿…é¡»ä¸º`127.0.0.1(localhost)`ï¼Œ`POST`é€‰æ‹©ä¸€ä¸ªä¸è¢«å ç”¨çš„é™åˆ¶ç«¯å£å³å¯ï¼Œå°½é‡ä¸è¦ä½¿ç”¨8080,80,22,443è¿™ç§çƒ­é—¨ç«¯å£

## å®‰è£…go-cqhttpæ’ä»¶

go-cqhttpä½¿æˆ‘ä»¬ç”¨æ¥è¿è¡Œbotæœºå™¨äººçš„æ’ä»¶ï¼Œå¯ä»¥ä»Žnonebotå•†åº—èŽ·å–å®‰è£…ï¼Œè¿™é‡Œè®°å½•äº¤äº’å¼å®‰è£…çš„è¿‡ç¨‹ï¼Œå…¶ä»–æ–¹å¼å¯ä»¥å‚è€ƒnonebotæ–‡æ¡£[èŽ·å–å•†åº—å†…å®¹ | NoneBot](https://nonebot.dev/docs/tutorial/store)

```bash
nb plugin install
```

æŒ‰äº¤äº’æç¤ºè¾“å…¥æ’ä»¶åï¼š` nonebot-plugin-gocqhttp`

æˆ–è€…ç›´æŽ¥ä¸€å¥`nb plugin install nonebot-plugin-gocqhttp`

![å®‰è£…gocqhttpæ’ä»¶](https://img.dodolalorc.cn/i/2024/10/01/66fbc1acf106c.png)

## ç™»å½•æœºå™¨äºº

go-cqhttpæ’ä»¶å®‰è£…å®Œæˆä¹‹åŽï¼Œæˆ‘ä»¬å†nb runä¸€ä¸‹ï¼Œæ¿€æ´»æ’ä»¶çš„å›¾å½¢åŒ–ç•Œé¢ã€‚

![å›¾å½¢åŒ–ç•Œé¢ç™»å½•](https://img.dodolalorc.cn/i/2024/10/01/66fbc1c6a3ac1.png)

å¤åˆ¶è¿™ä¸ªç½‘ç«™åˆ°æµè§ˆå™¨ï¼Œæˆ–è€…æŒ‰ä½Ctrlç‚¹å‡»è¿™æ­¥ä¸­çš„ç½‘å€è·³è½¬åˆ°é»˜è®¤æµè§ˆå™¨

![æµè§ˆå™¨æ‰“å¼€ç½‘å€](https://img.dodolalorc.cn/i/2024/10/01/66fbc1d367861.png)

æˆ‘ä»¬ç‚¹å‡»å·¦ä¾§ä¸Šæ–¹çš„æ·»åŠ è´¦å·ï¼Œå¡«å…¥è¦ç”¨ä½œæœºå™¨äººçš„qqå·ï¼Œå¯†ç ç•™ç©ºï¼Œç™»å½•è®¾å¤‡ç±»åž‹é€‰æ‹©`Android Watch`ç‚¹å‡»æäº¤

![æ·»åŠ æœºå™¨äººè´¦å·](https://img.dodolalorc.cn/i/2024/10/01/66fbc1de6a1d4.png)

åœ¨è¿›ç¨‹è¿™é‡Œç‚¹å‡»å¯åŠ¨

![å¯åŠ¨æœºå™¨äºº](https://img.dodolalorc.cn/i/2024/10/01/66fbc1e7b54b9.png)

æŽ¥ä¸‹æ¥åœ¨æ‰‹æœºä¸Šæ‰«æå‡ºçŽ°çš„äºŒç»´ç ç™»å½•å³å¯

![äºŒç»´ç ç™»å½•](https://img.dodolalorc.cn/i/2024/10/01/66fbc1eea52a3.png)

å¦‚æžœå‡ºçŽ°å½“å‰åè®®ä¸æ”¯æŒäºŒç»´ç ç™»å½•è¿™æ ·çš„é”™è¯¯æç¤ºï¼Œå¯ä»¥å…ˆctrl+cç»ˆæ­¢ï¼Œç„¶åŽåœ¨ç›®å½•çš„`./accounts/æœºå™¨äººçš„qqå·/device.json`ä¸­æ£€æŸ¥ä¸‹æ–¹è¿™ä¸€é¡¹æ˜¯å¦æ˜¯2ï¼Œè‹¥ä¸æ˜¯ï¼Œæ”¹ä¸º2ï¼Œç„¶åŽé‡æ–°ç™»å½•å³å¯ã€‚

```json
    "protocol": 2,
```

ç™»å½•æˆåŠŸä¹‹åŽæˆ‘ä»¬å¯¹è¿™ä¸ªæœºå™¨äººqqç§èŠå‘é€å¤è¯»æ¶ˆæ¯ï¼ˆå› ä¸ºå‰é¢è®¾ç½®çš„å‘½ä»¤èµ·å§‹å­—ç¬¦æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ç›´æŽ¥echoå³å¯ï¼Œå¦‚æžœèµ·å§‹è®¾ç½®æ˜¯"/"é‚£å°±è¦å†™æˆ"/echo xxx"

![å¤è¯»](https://img.dodolalorc.cn/i/2024/10/01/66fbc1fc36050.jpg)

è‹¥æˆåŠŸå¤è¯»è¡¨æ˜Žæœºå™¨äººéƒ¨ç½²æˆåŠŸã€‚

# 2.ç¼–å†™æ’ä»¶

å®˜æ–¹æ–‡æ¡£ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…³äºŽå¤©æ°”çš„å“åº”ï¼Œå»ºè®®å¯ä»¥å…ˆå†™ä¸€ä¸‹è¿™ä¸ªæ’ä»¶è¯•æ°´ã€‚

è¿™é‡Œä»‹ç»äº†å‰æœŸçš„å‡†å¤‡[æ’ä»¶ç¼–å†™å‡†å¤‡ | NoneBot](https://nonebot.dev/docs/tutorial/create-plugin)

## åˆ›å»ºç›®å½•

æˆ‘ä»¬å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º`./awesome-bot/plugins`ç›®å½•ï¼Œä¹‹åŽæˆ‘ä»¬çš„æ’ä»¶éƒ½ä¼šåœ¨è¿™ä¸ªpluginsç›®å½•ä¸‹ç¼–å†™ã€‚

æŽ¥ä¸‹æ¥åœ¨`./pyproject.toml`ä¸­æ·»åŠ plugin_dirså†…å®¹

```toml
[project]
name = "awesome-bot"
version = "0.1.0"
description = "awesome-bot"
readme = "README.md"
requires-python = ">=3.8, <4.0"

[tool.nonebot]
adapters = [
    { name = "OneBot V11", module_name = "nonebot.adapters.onebot.v11" }
]
plugins = ["nonebot_plugin_gocqhttp"]
plugin_dirs = ["awesome-bot/plugins"]   # ä¿®æ”¹çš„åœ°æ–¹
builtin_plugins = ["echo"]

```

å¦‚æžœä¸å°å¿ƒå¿½ç•¥äº†è¿™æ­¥importå¯¼è‡´ç›´æŽ¥æ·»åŠ æ’ä»¶å‡ºé”™ï¼Œå¯ä»¥è¯•è¯•æŠŠé”™è¯¯çš„æ–‡ä»¶åˆ äº†ï¼Œé‡æ–°è®¾ç½®å¥½ä¹‹åŽé‡æ–°æ‰“å¼€é¡¹ç›®æ–‡ä»¶

## åˆ›å»ºæ’ä»¶

æŽ¥ä¸‹æ¥ï¼Œä½¿ç”¨äº¤äº’å¼å‘½ä»¤åˆ›å»ºæ’ä»¶ï¼š

```bash
$ nb plugin create
[?] æ’ä»¶åç§°: weather
[?] ä½¿ç”¨åµŒå¥—æ’ä»¶? (y/N) N
[?] è¾“å‡ºç›®å½•: awesome_bot/plugins
```

è¿™æ—¶å€™`awesome_bot/plugins`ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ªweatheræ–‡ä»¶å¤¹ã€‚

é¡¹ç›®æ ‘åƒè¿™æ ·(å±•ç¤ºé¡¹ç›®æ ‘ï¼š`tree /f`)ï¼š

![é¡¹ç›®æ ‘](https://img.dodolalorc.cn/i/2024/10/01/66fbc20b208f1.png)

## åŠŸèƒ½ç¼–å†™

è¯·å‚è€ƒï¼š

[äº‹ä»¶å“åº”å™¨ | NoneBot](https://nonebot.dev/docs/tutorial/matcher)

[äº‹ä»¶å¤„ç† | NoneBot](https://nonebot.dev/docs/tutorial/handler)

[èŽ·å–äº‹ä»¶ä¿¡æ¯ | NoneBot](https://nonebot.dev/docs/tutorial/event-data)

[å¤„ç†æ¶ˆæ¯ | NoneBot](https://nonebot.dev/docs/tutorial/message)

è¿™äº›éƒ¨åˆ†ç®€å•ä»‹ç»äº†è¿™ä¸ªweatheræ’ä»¶ï¼Œè¯·ä¸€å®šè¯•è¿‡è¿™ä¸ªæ°´å†å†™å…¶ä»–çš„((

å»ºè®®ï¼šåœ¨å°è¯•å®žçŽ°å¦‚çˆ¬è™«ç­‰çš„åŠŸèƒ½æ—¶ï¼Œè¯·åœ¨å…¶ä»–åœ°æ–¹è°ƒè¯•å¥½pythonä»£ç å†ç²˜è´´åˆ°æ’ä»¶ä¸­ï¼Œæ³¨æ„æ•°æ®çš„typeç­‰é—®é¢˜ï¼Œå…³äºŽå¦‚ä½•çˆ¬è™«å¯ä»¥å‚è€ƒä¸€äº›çˆ¬è™«æ•™å­¦åšå®¢((æ‡’))

æœ¬ç¯‡çš„ç¤ºä¾‹`awesome-bot`è„±æ•å¤„ç†ä¹‹åŽå¼€æºè‡³github

å°æœºå™¨äººdodolaçš„ä»£ç è„±æ•ä¹‹åŽå·²ç»å¼€æºä¸Šä¼ åˆ°æœ¬äººçš„githubä¸Šï¼Œä»“åº“åœ°å€ï¼š

```bash
httpsï¼š
https://github.com/Florae006/nonebotworks.git
sshï¼š
git@github.com:Florae006/nonebotworks.git
github cliï¼š
gh repo clone Florae006/nonebotworks
```

dodolaå°æœºå™¨äººå®žçŽ°çš„åŠŸèƒ½å‚è€ƒä»“åº“ä¸­çš„readme.mdï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚

# 3.éƒ¨ç½²åˆ°æœåŠ¡å™¨

## DOCKERéƒ¨ç½²

nonebot2çš„è„šæ‰‹æž¶å¯ä»¥å¸®æˆ‘ä»¬å¿«é€Ÿä½¿ç”¨dockeréƒ¨ç½²ï¼Œå…·ä½“æ“ä½œå‚è€ƒï¼š[éƒ¨ç½² | NoneBot](https://nonebot.dev/docs/best-practice/deployment)

dockerå¯ä»¥å¸®åŠ©æˆ‘ä»¬é…ç½®æ‰€æœ‰çš„å¼€å‘çŽ¯å¢ƒä½¿ç”¨çš„ä¾èµ–ã€‚

## ç›´æŽ¥éƒ¨ç½²

å¦‚æžœä¸æ˜¯å¾ˆä¼šç”¨dockerï¼ˆæ¯”å¦‚æˆ‘ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æŽ¥ä¸Šä¼ åˆ°æœåŠ¡å™¨åŽå†é…ç½®è™šæ‹ŸçŽ¯å¢ƒï¼Œè¿›è¡Œæœºå™¨äººçš„éƒ¨ç½²

### åˆå§‹åŒ–éƒ¨ç½²

è¿™é‡Œä½¿ç”¨çš„æ˜¯å®å¡”é¢æ¿+XShellè¿œç¨‹æ¡Œé¢è¾…åŠ©æˆ‘ä»¬é…ç½®éƒ¨ç½²

ç™»å½•å®å¡”ä¹‹åŽï¼Œç‚¹å‡»å·¦ä¾§æ–‡ä»¶ï¼Œåœ¨æ ¹ç›®å½•æ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºŽå­˜æ”¾æˆ‘ä»¬çš„æœºå™¨äºº

åœ¨å‘½ä»¤è¡Œä¸­cdåˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œç»™nonebot2æœºå™¨äººé…ç½®åœ¨linuxä¸‹çš„çŽ¯å¢ƒï¼ˆå’Œwindowä¸‹ç±»ä¼¼

ä¾æ¬¡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å‡†å¤‡ä¸€äº›ä¾èµ–ï¼š

```bash
pip3 install nb-cli
pip3 install pydantic loguru pygtrie httpx python-dotenv uvicorn fastapi requests selenium aiocqhttp ffmpeg aiohttp -i https://pypi.tuna.tsinghua.edu.cn/simple/
pip3 install nonebot2 -i https://pypi.tuna.tsinghua.edu.cn/simple/
pip3 install nonebot-plugin-apscheduler nonebot-adapter-cqhttp  -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

åœ¨å½“å‰ç›®å½•ä¸‹(ç”¨æ¥å­˜æ”¾æœºå™¨äººçš„ç›®å½•ä¸‹)ï¼Œå‘½ä»¤è¡Œè¾“å…¥ï¼š

```bash
nb create
```

æ ¹æ®è„šæ‰‹æž¶çš„å¼•å¯¼åˆ›å»ºé¡¹ç›®ï¼ˆå‚è€ƒå‰æ–‡éƒ¨åˆ†çš„åˆå§‹åŒ–è®¾ç½®

![linuxä¸‹åˆå§‹åŒ–éƒ¨ç½²1](https://img.dodolalorc.cn/i/2024/10/01/66fbc21648452.png)

![linuxä¸‹åˆå§‹åŒ–éƒ¨ç½²2](https://img.dodolalorc.cn/i/2024/10/01/66fbc219a1135.png)

![linuxä¸‹åˆå§‹åŒ–éƒ¨ç½²3](https://img.dodolalorc.cn/i/2024/10/01/66fbc21d717c2.png)

æŒ‰ç…§æç¤ºrunä¸€ä¸‹ï¼Œç„¶åŽCtrl+Cé€€å‡ºï¼š

![linuxä¸‹åˆå§‹åŒ–éƒ¨ç½²4](https://img.dodolalorc.cn/i/2024/10/01/66fbc221ac7ad.png)

ç„¶åŽæˆ‘ä»¬ä¿®æ”¹é…ç½®æ–‡ä»¶`.env.prod`ï¼š

```toml
FASTAPI_RELOAD=false
HOST=0.0.0.0
PORT=36211
LOG_LEVEL=DEBUG
DRIVER=~fastapi   #æŒ‡å®šé©±åŠ¨å™¨ï¼Œé»˜è®¤å·²æœ‰
SUPERUSERS=["2407445307"]  # è¶…çº§ç®¡ç†å‘˜QQï¼Œå³æœºå™¨äººä¸»äººQQï¼Œæ”¹æˆè‡ªå·±çš„
COMMAND_START=["/", ""]  # é…ç½®å‘½ä»¤èµ·å§‹å­—ç¬¦
COMMAND_SEP=["."]  # é…ç½®å‘½ä»¤åˆ†å‰²å­—ç¬¦
```

ç„¶åŽå®‰è£…`nonebot-plugin-gocqhttp`æ’ä»¶

```bash
nb plugin install nonebot-plugin-gocqhttp
```

![å®‰è£…æ’ä»¶](https://img.dodolalorc.cn/i/2024/10/01/66fbc22c1c883.png)

ç„¶åŽå†runä¸€ä¸‹

![ç¬¬äºŒæ¬¡run](https://img.dodolalorc.cn/i/2024/10/01/66fbc232956fa.png)

ç„¶åŽæ‰“å¼€è¿™ä¸ªç½‘å€ï¼ˆæ³¨æ„æŠŠè¿™ä¸ª`0.0.0.0`æ¢æˆè‡ªå·±çš„æœåŠ¡å™¨ipå¹¶æŠŠè¿™ä¸ªç«¯å£å·ä»Žå®‰å…¨ç»„å¼€æ”¾å‡ºæ¥ï¼Œè¿›è¡Œæ­£å¸¸çš„æ‰«ç ç™»å½•

è¿™æ—¶å€™ç¢°åˆ°çš„æ„å¤–æ˜¯ï¼šç½‘ç»œå¤æ‚æ‹’ç»ç™»å½•ã€‚

æ²¡å…³ç³»ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬åªæ˜¯åˆ›å»ºä¸€ä¸‹accountsåŠå…¶æ–‡ä»¶ç½¢äº†ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å¤„ç†è¿™ä¸ªé—®é¢˜ï¼š

åœ¨æœºå™¨äººé¡¹ç›®çš„è¿™ä¸ªç›®å½•ä¸‹`./accounts/æœºå™¨äººqqå·`ä¸Šä¼ æˆ‘ä»¬åœ¨æœ¬åœ°æµ‹è¯•çŽ¯å¢ƒä¸‹çš„æœ‰æ•ˆç™»å½•çš„tokenæ–‡ä»¶ï¼š`session.token`ï¼ˆæœ¬åœ°ç›®å½•åœ°å€æ˜¯ä¸€æ ·çš„

ç„¶åŽé‡æ–°å¯åŠ¨ä¸€ä¸‹æœºå™¨äººï¼Œåº”è¯¥å°±èƒ½æ­£å¸¸è®¿é—®äº†ï¼ˆå¯ä»¥æµ‹è¯•ä¸€ä¸‹å¤è¯»åŠŸèƒ½

### ä¸Šä¼ æ’ä»¶

ç»è¿‡å‰é¢çš„é…ç½®ï¼Œæˆ‘ä»¬èŽ·å¾—äº†ä¸€ä¸ªåœ¨linuxä¸‹çš„æœºå™¨äººï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®å¡”é¢æ¿ä¸Šä¼ æ•´ä¸ªæˆ‘ä»¬æœ¬åœ°æµ‹è¯•å®Œçš„å·²ç»å†™å®Œçš„æ’ä»¶ï¼š

åœ¨æœºå™¨äººé¡¹ç›®çš„ç›®å½•ä¸‹ä¸Šä¼ æ•´ä¸ªæˆ‘ä»¬åœ¨æœ¬åœ°å†™çš„åŒ…å«`plugins`æ–‡ä»¶å¤¹çš„`awesome-bot`æ–‡ä»¶å¤¹ï¼Œå¹¶åƒä¹‹å‰é‚£æ ·ä¿®æ”¹`pyproject.toml`é‡Œçš„`plugin _dirs`ã€‚é‡æ–°è¿è¡Œå³å¯ä½¿ç”¨æˆ‘ä»¬å†™çš„æ’ä»¶äº†ã€‚

### å¯¼å…¥è™šæ‹ŸçŽ¯å¢ƒé…ç½®

å¦‚æžœæ˜¯ä½¿ç”¨dockerï¼Œé‚£è™šæ‹ŸçŽ¯å¢ƒè¿™å—ç†è®ºä¸Šä¸ç”¨æˆ‘ä»¬æ“å¿ƒï¼Œä¸è¿‡æ—¢ç„¶æ˜¯ç›´æŽ¥éƒ¨ç½²ï¼Œæˆ‘ä»¬æœ¬åœ°æœ‰çš„ç¼–ç¨‹çŽ¯å¢ƒè¿™ä¸ªåˆå§‹çŽ¯å¢ƒä¸ä¸€å®šæœ‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦å†é…ç½®ä¸€ä¸‹è™šæ‹ŸçŽ¯å¢ƒä¸­çš„ä¾èµ–äº†ã€‚

æˆ‘ä»¬å…ˆè¿›å…¥æˆ‘ä»¬é¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒï¼š

```bash
source .venv/bin/activate
```

![è¿›å…¥è™šæ‹ŸçŽ¯å¢ƒ](https://img.dodolalorc.cn/i/2024/10/01/66fbc23c9776f.png)

ç„¶åŽåœ¨è™šæ‹ŸçŽ¯å¢ƒä¸‹å®‰è£…æˆ‘ä»¬éœ€è¦çš„ä¾èµ–å°±è¡Œ

é€€å‡ºè™šæ‹ŸçŽ¯å¢ƒï¼š

```bash
deactivate
```

ä¹‹åŽæˆ‘ä»¬å¯åŠ¨æœºå™¨äººï¼Œå°±èƒ½æ­£å¸¸è¿è¡Œä»£ç äº†ã€‚

### åŽå°æŒ‚èµ·

ä½¿ç”¨`nohup`å‘½ä»¤æŒ‚èµ·æˆ‘ä»¬çš„å‘½ä»¤ï¼Œnohupçš„è¯­æ³•æ˜¯ï¼š`nohup æ‰§è¡Œçš„å‘½ä»¤ &`

```bash
nohup nb run &
```

æƒ³è¦å–æ¶ˆæŒ‚èµ·çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨`ps -ef |grep ç«¯å£å·`æŸ¥çœ‹å½“å‰åŽå°è¿›ç¨‹çš„pidï¼Œç„¶åŽä½¿ç”¨`kill pid`æ¥è§£æ”¾è¿™ä¸ªè¿›ç¨‹ã€‚

![åŽå°è¿›ç¨‹æŸ¥çœ‹](https://img.dodolalorc.cn/i/2024/10/01/66fbc246a2488.png)










